--- Pike-v7.4.20/src/configure.in.orig	Thu Apr  3 18:58:36 2003
+++ Pike-v7.4.20/src/configure.in	Fri Apr 25 10:13:19 2003
@@ -2451,8 +2451,8 @@
   fi
 fi
 
-AC_CHECK_LIB(nsl, gethostbyname)
-AC_CHECK_LIB(rt, nanosleep)
+AC_SEARCH_LIBS(gethostbyname, nsl)
+AC_SEARCH_LIBS(nanosleep, rt)
 
 AC_CHECK_LIB(dl, dlopen)
 AC_CHECK_LIB(dld, shl_load)
--- Pike-v7.4.20/src/modules/spider/configure.in.orig	Sat Aug 12 08:17:21 2000
+++ Pike-v7.4.20/src/modules/spider/configure.in	Fri Apr 25 15:18:48 2003
@@ -4,9 +4,9 @@
 
 AC_MODULE_INIT()
 
-AC_CHECK_LIB(bind, __inet_ntoa)
-AC_CHECK_LIB(socket, socket)
-AC_CHECK_LIB(nsl, gethostbyname)
+AC_SEARCH_LIBS(inet_ntoa, bind)
+AC_SEARCH_LIBS(socket, socket)
+AC_SEARCH_LIBS(gethostbyname, nsl)
 
 AC_HAVE_HEADERS(arpa/inet.h sys/socketvar.h sys/protosw.h \
 	netinet/in.h sys/mman.h sys/utsname.h netdb.h sys/socket.h \
--- Pike-v7.4.20/src/modules/files/configure.in.orig	Sun Mar 30 03:27:10 2003
+++ Pike-v7.4.20/src/modules/files/configure.in	Fri Apr 25 15:19:12 2003
@@ -13,8 +13,8 @@
  direct.h sys/wait.h process.h sys/file.h net/netdb.h limits.h unistd.h \
  termios.h poll.h sys/poll.h sys/select.h sys/un.h)
 AC_HEADER_DIRENT
-AC_CHECK_LIB(bind, __inet_ntoa)
-AC_CHECK_LIB(socket, socket)
+AC_SEARCH_LIBS(inet_ntoa, bind)
+AC_SEARCH_LIBS(socket, socket)
 
 AC_HAVE_FUNCS(getwd perror readdir_r statvfs statfs ustat lseek64 lstat fsync \
  grantpt unlockpt ptsname socketpair writev sendfile munmap madvise poll \
--- Pike-v7.4.20/src/modules/system/configure.in.orig	Mon Mar  3 19:24:29 2003
+++ Pike-v7.4.20/src/modules/system/configure.in	Fri Apr 25 15:23:18 2003
@@ -4,9 +4,9 @@
 
 AC_MODULE_INIT()
 
-AC_CHECK_LIB(bind, __inet_ntoa)
-AC_CHECK_LIB(socket, socket)
-AC_CHECK_LIB(nsl, gethostbyname)
+AC_SEARCH_LIBS(inet_ntoa, bind)
+AC_SEARCH_LIBS(socket, socket)
+AC_SEARCH_LIBS(gethostbyname, nsl)
 
 if test x"$pike_cv_sys_os" = xWindows_NT ; then
   # FIXME: These look suspiciouly much like 32bit versions.
@@ -87,8 +87,6 @@
   fi
 fi
 
-AC_CHECK_LIB(nsl, gethostbyname)
-
 AC_MSG_CHECKING(for solaris style gethostbyname_r)
 
 AC_CACHE_VAL(pike_cv_have_solaris_gethostbyname_r,
--- Pike-v7.4.20/src/modules/sybase/configure.in.orig	Wed Jan 16 04:06:15 2002
+++ Pike-v7.4.20/src/modules/sybase/configure.in	Fri Apr 25 15:28:11 2003
@@ -115,7 +115,7 @@
 if test x$with_sybase != xno; then
     AC_CHECK_LIB(m,floor)
     AC_CHECK_LIB(dl,dlopen)
-    AC_CHECK_LIB(nsl,gethostbyname)
+    AC_SEARCH_LIBS(gethostbyname, nsl)
 
     AC_SEARCH_LIBS(intl_datetime,intl_r64 intl_r intl64 intl,AC_DEFINE(PIKE_HAVE_LIBINTL))
     AC_SEARCH_LIBS(comn_bintobin,comn_r64 comn_r comn_dce64 comn_dce comn64 comn,AC_DEFINE(PIKE_HAVE_LIBCOMN))
--- Pike-v7.4.20/src/modules/Msql/configure.in.orig	Wed Jan 16 04:10:17 2002
+++ Pike-v7.4.20/src/modules/Msql/configure.in	Fri Apr 25 15:29:01 2003
@@ -77,8 +77,8 @@
 	fi
 
 		# On some OS's (Solaris 2) these are requiered
-		AC_CHECK_LIB(socket, socket, [], [])
-		AC_CHECK_LIB(nsl, gethostbyname, [], [])
+		AC_SEARCH_LIBS(socket, socket)
+		AC_SEARCH_LIBS(gethostbyname, nsl)
 
 		AC_CHECK_LIB(msql, msqlClose)
 		if test "$ac_cv_lib_msql_msqlClose" != "no"; then
--- Pike-v7.4.20/src/modules/Mysql/configure.in.orig	Sat Mar 29 11:52:20 2003
+++ Pike-v7.4.20/src/modules/Mysql/configure.in	Fri Apr 25 15:30:05 2003
@@ -128,10 +128,11 @@
   if echo $LIBS|grep -- -lnsl >&5 2>&5; then
     :
   else
+    AC_CHECK_FUNC(gethostbyname,,[
     AC_CHECK_LIB(nsl, gethostbyname, [
       LIBS="-lnsl $LIBS"
       MYSQL_LIBS="-lnsl ${MYSQL_LIBS}"
-    ], [])
+    ], [])])
   fi
   if echo $LIBS|grep -- -lm >&5 2>&5; then
     :
--- Pike-v7.4.20/src/modules/Odbc/configure.in.orig	Tue Mar 13 16:10:33 2001
+++ Pike-v7.4.20/src/modules/Odbc/configure.in	Fri Apr 25 15:30:31 2003
@@ -167,9 +167,10 @@
   	if echo $LIBS|grep -- -lnsl >&5 2>&5; then
   	  :
   	else
+	  AC_CHECK_FUNC(gethostbyname,,[
   	  AC_CHECK_LIB(nsl, gethostbyname, [
   	    LIBS="-lnsl $LIBS"
-  	  ], [])
+  	  ], [])])
   	fi
   	if echo $LIBS|grep -- -lm >&5 2>&5; then
   	  :
